import{aB as m}from"./index-BnbTlfOu.js";import{w as A,u as S,S as L}from"./xlsx-C7_Yxo3L.js";var _={exports:{}};(function(l,p){(function(c,o){o()})(m,function(){function c(e,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function o(e,t,s){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){v(n.response,t,s)},n.onerror=function(){console.error("could not download file")},n.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof m=="object"&&m.global===m?m:void 0,h=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),v=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!h?function(e,t,s){var n=r.URL||r.webkitURL,f=document.createElement("a");t=t||e.name||"download",f.download=t,f.rel="noopener",typeof e=="string"?(f.href=e,f.origin===location.origin?a(f):i(f.href)?o(e,t,s):a(f,f.target="_blank")):(f.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(f.href)},4e4),setTimeout(function(){a(f)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,s){if(t=t||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(c(e,s),t);else if(i(e))o(e,t,s);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){a(n)})}}:function(e,t,s,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return o(e,t,s);var f=e.type==="application/octet-stream",u=/constructor/i.test(r.HTMLElement)||r.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||f&&u||h)&&typeof FileReader<"u"){var b=new FileReader;b.onloadend=function(){var w=b.result;w=d?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=w:location=w,n=null},b.readAsDataURL(e)}else{var x=r.URL||r.webkitURL,g=x.createObjectURL(e);n?n.location=g:location.href=g,n=null,setTimeout(function(){x.revokeObjectURL(g)},4e4)}});r.saveAs=v.saveAs=v,l.exports=v})})(_);var E=_.exports;function k(l){for(var p=[],c=l.querySelectorAll("tr"),o=[],i=0;i<c.length;++i){for(var a=[],r=c[i],h=r.querySelectorAll("td"),v=0;v<h.length;++v){var e=h[v],t=e.getAttribute("colspan"),s=e.getAttribute("rowspan"),n=e.innerText;if(n!==""&&n==+n&&(n=+n),o.forEach(function(u){if(i>=u.s.r&&i<=u.e.r&&a.length>=u.s.c&&a.length<=u.e.c)for(var d=0;d<=u.e.c-u.s.c;++d)a.push(null)}),(s||t)&&(s=s||1,t=t||1,o.push({s:{r:i,c:a.length},e:{r:i+s-1,c:a.length+t-1}})),a.push(n!==""?n:null),t)for(var f=0;f<t-1;++f)a.push(null)}p.push(a)}return[p,o]}function B(l,p){var c=Date.parse(l);return(c-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3)}function j(l,p){for(var c={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},i=0;i!=l.length;++i)for(var a=0;a!=l[i].length;++a){o.s.r>i&&(o.s.r=i),o.s.c>a&&(o.s.c=a),o.e.r<i&&(o.e.r=i),o.e.c<a&&(o.e.c=a);var r={v:l[i][a]};if(r.v!=null){var h=S.encode_cell({c:a,r:i});typeof r.v=="number"?r.t="n":typeof r.v=="boolean"?r.t="b":r.v instanceof Date?(r.t="n",r.z=L._table[14],r.v=B(r.v)):r.t="s",c[h]=r}}return o.s.c<1e7&&(c["!ref"]=S.encode_range(o)),c}function y(){if(!(this instanceof y))return new y;this.SheetNames=[],this.Sheets={}}function T(l){for(var p=new ArrayBuffer(l.length),c=new Uint8Array(p),o=0;o!=l.length;++o)c[o]=l.charCodeAt(o)&255;return p}function F(l){var p=document.getElementById(l),c=k(p),o=c[1],i=c[0],a="SheetJS",r=new y,h=j(i);h["!merges"]=o,r.SheetNames.push(a),r.Sheets[a]=h;var v=A(r,{bookType:"xlsx",bookSST:!1,type:"binary"});E.saveAs(new Blob([T(v)],{type:"application/octet-stream"}),"test.xlsx")}function M({multiHeader:l=[],header:p,data:c,filename:o,merges:i=[],autoWidth:a=!0,bookType:r="xlsx"}={}){o=o||"excel-list",c=[...c],c.unshift(p);for(let s=l.length-1;s>-1;s--)c.unshift(l[s]);var h="SheetJS",v=new y,e=j(c);if(i.length>0&&(e["!merges"]||(e["!merges"]=[]),i.forEach(s=>{e["!merges"].push(S.decode_range(s))})),a){const s=c.map(f=>f.map(u=>u==null?{wch:10}:u.toString().charCodeAt(0)>255?{wch:u.toString().length*2}:{wch:u.toString().length}));let n=s[0];for(let f=1;f<s.length;f++)for(let u=0;u<s[f].length;u++)n[u].wch<s[f][u].wch&&(n[u].wch=s[f][u].wch);e["!cols"]=n}v.SheetNames.push(h),v.Sheets[h]=e;var t=A(v,{bookType:r,bookSST:!1,type:"binary"});E.saveAs(new Blob([T(t)],{type:"application/octet-stream"}),`${o}.${r}`)}export{M as export_json_to_excel,F as export_table_to_excel};
