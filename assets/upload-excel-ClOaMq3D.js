import{P as B,Q as E,o as f,c as b,ah as N,ae as S,a4 as y,aa as C,V as _,a5 as z,aw as h,as as U,aF as V,ab as O,aJ as $,aK as A}from"./index-BnbTlfOu.js";import{r as K,u as d}from"./xlsx-C7_Yxo3L.js";const j={__name:"index",props:{size:{type:Number,default:5}},emits:["uploadSuccess"],setup(D,{emit:o}){const g=o,p=D,s=B({loading:!1,refInput:null}),{loading:n,refInput:k}=E(s),m=e=>{const t=[],a=d.decode_range(e["!ref"]);let r;const i=a.s.r;for(r=a.s.c;r<=a.e.c;++r){const c=e[d.encode_cell({c:r,r:i})];let u="UNKNOWN "+r;c&&c.t&&(u=d.format_cell(c)),t.push(u)}return t},x=e=>{s.loading=!0;const t=new FileReader;t.onload=a=>{const r=a.target.result,i=K(r,{type:"array"}),c=i.SheetNames[0],u=i.Sheets[c],P=m(u),R=d.sheet_to_json(u);g("uploadSuccess",{header:P,results:R}),s.loading=!1},t.readAsArrayBuffer(e)},l=e=>e.size/1024/1024<p.size?!0:(h.warning(`Please do not upload files larger than ${p.size}m in size.`),!1),w=e=>{s.refInput.value=null,l(e)&&x(e)},I=e=>{const a=e.target.files[0];a&&w(a)},T=e=>/\.(xlsx|xls|csv)$/.test(e.name),F=e=>{if(e.stopPropagation(),e.preventDefault(),s.loading)return;const t=e.dataTransfer.files;if(t.length!==1)return h.error("Only support uploading one file!");const a=t[0];if(!T(a))return h.error("Only supports upload .xlsx, .xls, .csv suffix files");w(a)},v=e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},H=()=>{s.refInput.click()};return(e,t)=>{const a=U;return f(),b(z,null,[N("input",{ref_key:"refInput",ref:k,class:"excel-upload-input",type:"file",accept:".xlsx, .xls",onChange:I},null,544),N("div",{class:"drop",onDrop:F,onDragover:v,onDragenter:v},[t[1]||(t[1]=S(" Drop excel file here or ")),y(a,{loading:_(n),style:{"margin-left":"16px"},type:"primary",onClick:H},{default:C(()=>t[0]||(t[0]=[S(" Browse ")])),_:1},8,["loading"])],32)],64)}}},J={class:"upload-excel-container"},Q={__name:"upload-excel",setup(D){const o=B({tableData:[],tableHeader:[]}),{tableData:g,tableHeader:p}=E(o),s=n=>{o.tableData=n.results,o.tableHeader=n.header};return(n,k)=>{const m=$,x=A;return f(),b("div",J,[y(_(j),{onUploadSuccess:s}),y(x,{data:_(g),border:"","highlight-current-row":"",style:{width:"100%","margin-top":"20px"}},{default:C(()=>[(f(!0),b(z,null,V(_(p),l=>(f(),O(m,{key:l,prop:l,label:l},null,8,["prop","label"]))),128))]),_:1},8,["data"])])}}};export{Q as default};
