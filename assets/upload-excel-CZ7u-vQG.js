import{P as S,Q as C,o as f,c as b,ah as N,ae as B,a4 as y,aa as E,V as _,a5 as z,aC as h,as as V,aw as A,ab as F,aA as O,aB as $}from"./index-Br7pTrl8.js";import{r as j,u as d}from"./xlsx-C7_Yxo3L.js";const K={__name:"index",props:{size:{type:Number,default:5}},emits:["uploadSuccess"],setup(D,{emit:o}){const g=o,p=D,s=S({loading:!1,refInput:null}),{loading:n,refInput:k}=C(s),m=e=>{const t=[],a=d.decode_range(e["!ref"]);let r;const i=a.s.r;for(r=a.s.c;r<=a.e.c;++r){const c=e[d.encode_cell({c:r,r:i})];let u="UNKNOWN "+r;c&&c.t&&(u=d.format_cell(c)),t.push(u)}return t},x=e=>{s.loading=!0;const t=new FileReader;t.onload=a=>{const r=a.target.result,i=j(r,{type:"array"}),c=i.SheetNames[0],u=i.Sheets[c],R=m(u),U=d.sheet_to_json(u);g("uploadSuccess",{header:R,results:U}),s.loading=!1},t.readAsArrayBuffer(e)},l=e=>e.size/1024/1024<p.size?!0:(h.warning(`Please do not upload files larger than ${p.size}m in size.`),!1),w=e=>{s.refInput.value=null,l(e)&&x(e)},I=e=>{const a=e.target.files[0];a&&w(a)},T=e=>/\.(xlsx|xls|csv)$/.test(e.name),H=e=>{if(e.stopPropagation(),e.preventDefault(),s.loading)return;const t=e.dataTransfer.files;if(t.length!==1)return h.error("Only support uploading one file!");const a=t[0];if(!T(a))return h.error("Only supports upload .xlsx, .xls, .csv suffix files");w(a)},v=e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},P=()=>{s.refInput.click()};return(e,t)=>{const a=V;return f(),b(z,null,[N("input",{ref_key:"refInput",ref:k,class:"excel-upload-input",type:"file",accept:".xlsx, .xls",onChange:I},null,544),N("div",{class:"drop",onDrop:H,onDragover:v,onDragenter:v},[t[1]||(t[1]=B(" Drop excel file here or ")),y(a,{loading:_(n),style:{"margin-left":"16px"},type:"primary",onClick:P},{default:E(()=>t[0]||(t[0]=[B(" Browse ")])),_:1},8,["loading"])],32)],64)}}},L={class:"upload-excel-container"},W={__name:"upload-excel",setup(D){const o=S({tableData:[],tableHeader:[]}),{tableData:g,tableHeader:p}=C(o),s=n=>{o.tableData=n.results,o.tableHeader=n.header};return(n,k)=>{const m=O,x=$;return f(),b("div",L,[y(_(K),{onUploadSuccess:s}),y(x,{data:_(g),border:"","highlight-current-row":"",style:{width:"100%","margin-top":"20px"}},{default:E(()=>[(f(!0),b(z,null,A(_(p),l=>(f(),F(m,{key:l,prop:l,label:l},null,8,["prop","label"]))),128))]),_:1},8,["data"])])}}};export{W as default};
